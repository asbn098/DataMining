---
title: "Untitled"
author: "ParkJiyeon"
date: '2019 11 21 '
output: word_document
---

```{r regression}
library(ggplot2)
install.packages("https://CRAN.R-project.org/package=TTR")
library(TTR)
library(forecast)
total <- read.csv("C:/Users/박지연/Desktop/4년피자최종데이터.csv", header = TRUE)
plot(total,type)
str(total)

#시계열 데이터로 변환
head(total)
total_ts <-ts(total$order_mean)
plot.ts(total_ts)
str(total_ts)

acf(total_ts,lag.max=20)
pacf(total_ts,lag.max=20)

tip<-auto.arima(total_ts)
tip

#시계열 데이터를 이동평균한 값을 생성(MA모형)
total_sma3<-SMA(total_ts,n=1)
plot.ts(total_sma3)


#차분을 통해 데이터를 정상화(AR모형)
total_diff1<-diff(total_ts,differences=30)
plot.ts(total_diff1)


#1차 차분한 데이터로 ARIMA 모형 확인
acf(total_diff1,lag.max=20)# lag 2부터 점선 안에 존재. lag 절단값 = 2 --> MA(1)

pacf(total_diff1,lag.max=20)# lag 4에서 절단값 -->AR(3)

#autoarima

#예측,ARIMA(p,d,q)-p:AR모형차수/d:차분차수/q:MA모형차수
total_arima<-arima(total_ts,order=c(0,1,0))#차분을 통해 확인한 값 적용

total_fcast<-forecast(total_arima,h=5)
plot(total_fcast)

```
library(rpart)
m <- rpart(b~a ,method = "anova",data = total)

printcp(m)

plotcp(m)

summary(m)

par(mfrow=c(1,2))
rsq.rpart(m)

plot(m,uniform=TRUE,main="Regression Tree for term in months")
text(m,use.n=TRUE,all=TRUE,cex=0.9)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
p <- gplot(data=total, aes(x=temp, y=order, size=hp, color=wt)) + geom_point()
p + stat_smooth(color='black', fill='grey')



```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
